"use strict";var bgWeather={data:{today:{code:"29",temp:{current:"NaN",high:"NaN",low:"37"},text:"NaN",humidity:"NaN",pressure:"NaN",wind:"NaN"},future:[{code:"34",date:(new Date).getTime()+864e5,high:"",low:"",text:"NaN"},{code:"28",date:(new Date).getTime()+1728e5,high:"",low:"",text:"NaN"},{code:"30",date:(new Date).getTime()+2592e5,high:"",low:"",text:"NaN"},{code:"30",date:(new Date).getTime()+3456e5,high:"",low:"",text:"NaN"},{code:"39",date:(new Date).getTime()+432e6,high:"",low:"",text:"NaN"}],location:{city:"Locating",country:"..."},woeid:infinity.isZh()?2151330:2459115},init:function(){var t=this;infinity.alarms.onAlarm("queryWeather",function(e){chrome.permissions.contains({origins:["https://www.yahoo.com/*"]},function(e){e&&t.queryWeather()})}),t.initData(function(e){infinity.setting("woeid",e.woeid),infinity.alarms.create("queryWeather",{periodInMinutes:30})}),infinity.onMessage("recoverySuccess",function(){var e=infinity.setting("woeid");e&&t.queryWeather(e)})},initData:function(t){var i=this;try{i.tempUnitC=infinity.setting("tempUnitC")}catch(e){i.tempUnitC=!0}infinity.get("infinity-weather",!0,function(e){e&&t&&t(e)}),infinity.init("infinity-weather",i.data,!0,function(){t&&t(i.data)})},tempUnitC:!0,transUnit:function(t){try{var e=parseInt(t);return this.tempUnitC?Math.round((e-32)/1.8):e}catch(e){return t}},setTheCityWeather:function(t){var i=this;i.initData(function(){i.queryCity(t,function(e){i.queryWeather(e.woeid)})}),infinity.get("infinity-weather",!0,function(e){e&&i.queryCity(t,function(e){i.queryWeather(e.woeid)})})},queryCity:function(e,i){e="https://www.yahoo.com/news/_td/api/resource/WeatherSearch;text="+encodeURIComponent(e)+"?bkt=news-d-147&device=desktop&feature=cacheContentCanvas%2Ccanvass%2Cfeaturebar%2CdeferModalCluster%2CspecRetry&intl="+chrome.i18n.getUILanguage()+"&lang="+chrome.i18n.getUILanguage()+"&partner=none&region=US&site=fp&tz=America%2FLos_Angeles&ver=2.0.2213002&returnMeta=true&t="+(new Date).getTime();$.ajax({url:e,dataType:"json"}).done(function(e){try{var t=e.data.splice(0,20);t.length&&i&&i(t[0])}catch(e){}})},queryWeather:function(t){infinity.get("infinity-weather",!0,function(e){var a=void 0,e="https://www.yahoo.com/news/_tdnews/api/resource/WeatherService;woeids=%5B"+(a=t||e.woeid)+"%5D?t="+Date.now();$.ajax({url:e,dataType:"json"}).done(function(e){try{var t,i,n=e.weathers[0];n&&n.location&&n.location.woeid==a&&n.provider&&n.provider.name&&(t=n.observation,(i={}).today={code:t.conditionCode,temp:{current:t.temperature.now,high:t.temperature.high,low:t.temperature.low},text:t.conditionDescription,humidity:t.humidity+" %",pressure:t.barometricPressure.toFixed(1)+" bar",wind:t.windSpeed+" mph"},i.future=[],i.location={},i.location.country=n.location.countryName,i.location.city=n.location.displayName,i.woeid=a,infinity.setting("woeid",a),n.forecasts.daily.map(function(e,t){0<t&&t<6&&((t={}).code=e.conditionCode,t.date=new Date(e.observationTime.timestamp),t.high=e.temperature.high,t.low=e.temperature.low,t.text=e.conditionDescription,i.future.push(t))}),infinity.set("infinity-weather",i,!0),infinity.sendMessage("updateWeather"))}catch(e){}})})}};