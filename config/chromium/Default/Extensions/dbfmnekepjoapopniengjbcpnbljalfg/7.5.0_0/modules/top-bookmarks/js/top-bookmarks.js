"use strict";infinity.modules["top-bookmarks-top-bookmarks"]=function(){return new Vue({el:"#topBookMarks",data:{isShow:!1,bookData:null,commombookdata:null,commonbookdatashow:null,commonbookdatashoalast:null,isshowmorebookdata:!1,isshowOtherData:!1,otherbookdata:null,secondbookdata:null,threebookdata:null,forthbookdata:null,secondbookmoredata:null,threebookmoredata:null,forthbookmoredata:null,activingindex:-1,isShowSecondbook:!1,tempLen:0,ulwidth:0,tempid:-1,tempidsi:-1,sibookdata:null,FMDid:-1,SMDid:-1,FOMDid:-1,isHavedClick:!1,otherbookmarks:infinity.i18n("otherbookmarks"),settings:infinity.get("infinity-settings"),chromeUrl:infinity.faviconUrl,notBookmarksPermission:infinity.i18n("require_new_permissition",infinity.i18n("name"))+":"+infinity.i18n("get_bookmarks")},created:function(){var o,i=this;chrome.bookmarks?(i.openOverhide(),chrome.bookmarks.getTree(function(o){i.bookData=o,i.commombookdata=o[0].children[0].children,i.commucateShow()})):chrome.bookmarks||(o='<button id="startBookmarks">'+i.notBookmarksPermission+"</button>",$("#bookmarkbar").append(o)),$(document).on("click","#startBookmarks",function(){var t=$(this);chrome.permissions.request({permissions:["bookmarks"],origins:["chrome://favicon/"]},function(o){o&&(t.remove(),chrome.bookmarks.getTree(function(o){i.bookData=o,i.commombookdata=o[0].children[0].children,i.commucateShow()}))})}),$(window).resize(function(o){o.isTrigger||(clearTimeout(this._timer),this._timer=setTimeout(function(){i.commucateShow()},250))}),$("#search-input").on("click",function(o){var t=$(".site-li-boxnot-click");t.is(o.target)||0!==t.has(o.target).length||i.isHavedClick&&(i.isHavedClick=!1,i.hidemainbookdata(),i.hidethebook())}),$(document).on("click",function(o){var t=$(".site-li-boxnot-click");t.is(o.target)||0!==t.has(o.target).length||(i.isHavedClick=!1,i.hidemainbookdata(),i.hidethebook())}),infinity.onMessage("settingBookMarkOpenWay",function(){i.settings=infinity.get("infinity-settings")})},methods:{openOverhide:function(){$(".app-top").css("overflow","visible")},hidethebook:function(){var o=this;o.isshowmorebookdata&&(o.isshowmorebookdata=!1),o.isshowOtherData&&(o.isshowOtherData=!1),o.FMDid=-1},show:function(){var o,t=this;t.openOverhide(),chrome.bookmarks&&(0!=(o=$("#startBookmarks")).length&&o.remove(),chrome.bookmarks.getTree(function(o){t.bookData=o,t.commombookdata=o[0].children[0].children,t.commucateShow()}))},hide:function(){var o=$("#topSites"),t=$(".home-infinity");0!=o.length?(o.css("top","0px"),t.css("top","28px")):(0!=o.length&&"none"!=o.css("display")&&o.css("top","0px"),t.css("top","20px")),this.isShow=!1},initSecondbook:function(o,i,t){var e,s,a,n=this;this.isHavedClick&&(n.isShowSecondbook&&i==this.activingindex||(this.hidemainbookdata(),e=$(t.currentTarget),s=$("body").width(),a=e.offset().left,chrome.bookmarks.getChildren(o,function(o){var t;0==o.length&&(t={title:infinity.i18n("empty"),href:"/modules/topBookMarks/img/empt.png"},o.push(t)),n.hidethebook(),n.secondbookdata=o,n.activingindex=i,n.showthisbook(i),n.$nextTick(function(){s-a<360&&e.find(".first-secondbook-box").css({right:-8,left:"auto"})})})))},initClickBookData:function(o,t,i){if(this.isHavedClick)return this.isHavedClick=!1,this.hidemainbookdata(),void this.hidethebook();this.isHavedClick=!0,this.initSecondbook(o,t,i)},showthisbook:function(){this.isShowSecondbook=!0},hideSecondbook:function(){this.activingindex=-1,this.isShowSecondbook=!1},openbookmarks:function(o,t){t||(SETTING.isOpenBookmarkInNewTab?chrome.tabs.create({url:o},function(){}):chrome.tabs.update({url:o},function(){}))},hidemainbookdata:function(o){this.hidethebook(),this.activingindex=o,this.isShowSecondbook=!1,this.tempid=-1,this.tempidsi=-1,this.SMDid=-1,this.FOMDid=-1},commucateShow:function(){var o=$("#more-bookmark-box").width(),t=$("body").width()-o;this.ulwidth=t;var i=Math.ceil(t/60),o=Math.ceil(t/180),o=Math.ceil((i+o)/2);this.tempLen=o,$("#ulbookdatashowbox").css("maxWidth",t-16),this.dealbookdata()},dealbookdata:function(){this.commombookdata&&(this.commonbookdatashow=this.commombookdata.slice(0,this.tempLen),this.$nextTick(function(){var o=0;if($("#ulbookdatashowbox>ul>li").each(function(){o+=$(this).outerWidth()}),o<200)return this.commombookdata.length<=this.tempLen?$(".more-bookmark-is-Show").css("visibility","hidden"):$(".more-bookmark-is-Show").css("visibility","visible"),void $("#topBookMarks").css("visibility","visible");o<this.ulwidth-26&&(this.commombookdata.length<=this.tempLen?$(".more-bookmark-is-Show").css("visibility","hidden"):$(".more-bookmark-is-Show").css("visibility","visible"),$("#topBookMarks").css("visibility","visible")),o>this.ulwidth-26&&(this.tempLen=this.tempLen-1,this.dealbookdata())}))},downloadmoredata:function(o){var t=this;chrome.bookmarks.getChildren(o,function(o){t.secondbookdata=o})},initthreeDate:function(e,o){var s,a,n,h,r,d,c,k=this,m=$(o.target);k.tempid!=e&&(o=$("body").width(),s=$("body").height(),a=o-m.offset().left-350,n=m.offset().top,h=Math.ceil(s-n),c=d=r=0,chrome.bookmarks.getChildren(e,function(o){var t,i=o.length;0==i&&(t={title:infinity.i18n("empty"),href:"/modules/topBookMarks/img/empt.png"},o.push(t),r=26,c=n),0!=i&&((d=26*i+2)<h-26?(r=h,c=n):h<=d&&(r=h,c=d<s?s-d-26:30)),40<r&&(r-=10),c<30&&(c=30),k.threebookdata=o,k.tempid=e,k.$nextTick(function(){350<a?$(".threebook-box").css({left:m.offset().left+350-11,top:c,"max-height":s-80}):$(".threebook-box").css({left:m.offset().left-200,top:c,"max-height":s-80})})}))},openthreshowdata:function(o){this.tempid=o,this.tempidsi=-1},openforthshowdata:function(o){this.tempidsi=o},initforthData:function(e,o){var t,s,a,n,h,r,d,c,k,m=this;m.tempidsi==e&&-1!=e||(t=$(o.target),s=t.offset(),o=$("body").width(),a=$("body").height(),n=o-t.offset().left-200,h=t.offset().top,r=Math.ceil(a-h),k=c=d=0,chrome.bookmarks.getChildren(e,function(o){var t,i=o.length;0==i&&(t={title:infinity.i18n("empty"),href:"/modules/topBookMarks/img/empt.png"},o.push(t),d=26,k=h),m.tempidsi=e,m.sibookdata=o,0!=i&&((c=26*i+2)<r-26?(d=r,k=h):r<c&&(d=r,k=c<a?a-c-26:30)),40<d&&(d-=10),k<30&&(k=30),m.$nextTick(function(){200<n?$(".forthbook-box").css({left:s.left+200-11,top:k,"max-height":a-80}):$(".forthbook-box").css({left:s.left-200,top:k,"max-height":a-80})})}))},showMorebookData:function(){this.isHavedClick&&(this.isshowOtherData&&(this.isshowOtherData=!1),this.commonbookdatashoalast=this.commombookdata.slice(this.tempLen,this.commombookdata.length),this.isshowmorebookdata=!0,this.isShowSecondbook=!1)},showinitmorebookdata:function(){this.isHavedClick?(this.isHavedClick=!1,this.hidemainbookdata(),this.hidethebook()):(this.isHavedClick=!0,this.showMorebookData())},otherDataclick:function(){this.isHavedClick?(this.isHavedClick=!1,this.hidemainbookdata(),this.hidethebook()):(this.isHavedClick=!0,this.initohterdata())},initohterdata:function(){var o;this.isHavedClick&&(this.isshowmorebookdata&&(this.isshowmorebookdata=!1),this.otherbookdata=this.bookData[0].children[1].children,0==this.otherbookdata.length&&(o={title:infinity.i18n("empty"),href:"/modules/topBookMarks/img/empt.png"},this.otherbookdata.push(o)),this.isshowOtherData=!0,this.isShowSecondbook=!1)},openMoreBookDataSecond:function(e,o){var s,a,n,h,r,d,c=this;c.FMDid==e&&-1!=e||(o=$(o.target).offset(),$("body").width(),s=$("body").height(),a=o.top,n=Math.ceil(s-a),d=r=h=0,chrome.bookmarks.getChildren(e,function(o){var t,i=o.length;0==i&&(t={title:infinity.i18n("empty"),href:"/modules/topBookMarks/img/empt.png"},o.push(t),h=26,d=a),c.FMDid=e,c.secondbookmoredata=o,0!=i&&((r=26*i)<n?(h=n,d=a):n<r&&(h=n,d=r<s?s-r-26:30)),40<h&&(h-=10),d<30&&(d=30),c.$nextTick(function(){$(".firstload-more-book-data").css({right:350,top:d,"max-height":s-80})})}))},hideSecondmoreData:function(o){this.FMDid=o,this.SMDid=-1},hideThreemoreData:function(o){this.SMDid=o,this.FOMDid=-1},openMoreBookDataThree:function(e,o){var s,a,n,h,r,d,c=this;c.SMDid==e&&-1!=e||(o=$(o.target).offset(),$("body").width(),s=$("body").height(),a=o.top,n=Math.ceil(s-a),d=r=h=0,chrome.bookmarks.getChildren(e,function(o){var t,i=o.length;0==i&&(t={title:infinity.i18n("empty"),href:"/modules/topBookMarks/img/empt.png"},o.push(t),h=26,d=a),c.SMDid=e,c.threebookmoredata=o,0!=i&&((r=26*i)<n?(h=n,d=a):n<r?(h=n,d=r<s?s-r-26:30):h=n),40<h&&(h-=10),d<30&&(d=30),c.$nextTick(function(){$(".secondload-more-book-data").css({right:550,top:d,"max-height":s-80})})}))},openMoreBookDataForth:function(e,o){var s,a,n,h,r,d,c=this;c.FOMDid==e&&-1!=e||(o=$(o.target).offset(),$("body").width(),s=$("body").height(),a=o.top,n=Math.ceil(s-a),d=r=h=0,chrome.bookmarks.getChildren(e,function(o){var t,i=o.length;0==i&&(t={title:infinity.i18n("empty"),href:"/modules/topBookMarks/img/empt.png"},o.push(t),h=26,d=a),c.FOMDid=e,c.forthbookmoredata=o,0!=i&&((r=26*i)<n?(h=n,d=a):n<r&&(h=n,d=r<s?s-r-26:30)),40<h&&(h-=10),d<30&&(d=30),c.$nextTick(function(){$(".threeload-more-book-data").css({right:750,top:d,"max-height":s-80})})}))},hideForthmoreData:function(o){this.FOMDid=o}}})};